---
title: "Bellabeat Case Study"
author: "Brian Nguyen"
date: "2022-12-10"
output: html_document
---

### **Bellabeat Capstone Project**  

This case study is one of the assigned projects for the completion of the Google Data Analytics Professional Certificate. The eight course program equips students with all the essential tools and skills as well as the six phases of the data analysis process. For this case study, I will be performing my analysis in R.

- - -

### **Table of Contents**  
1. Summary  

2. Ask Phase  

  - 2.1 Business task  

3. Prepare Phase  

  - 3.1 Dataset used  

  - 3.2 Data privacy  

  - 3.3 Information about the dataset  

  - 3.4 Organizing and verifying data's integrity  

  - 3.5 Data restrictions  

4. Process Phase  

  - 4.1 Installing and loading packages  

  - 4.2 Importing the dataset  

  - 4.3 Previewing the dataset  

  - 4.4 Data cleaning and formatting  

  - 4.5 Merging datasets  

5. Analyze Phase and Share Phase  

  - 5.1 Separating by usage type  
  
  - 5.2 Relationship between Total Steps and Calories  
  
  - 5.3 Relationship between Total Minutes Asleep and Sedentary Minutes  
  
  - 5.4 Relationship between Total Minutes Asleep and Total Time In Bed  
  
  - 5.5 Relationship between Time of Day and Total Intensity  
  
  - 5.6 Average Steps Per Hour  
  
6. Act Phase (Recommendations)  

- - -

### **1. Summary**  

Bellabeat, a high-tech company that manufactures health-focused smart products, was founded by Urška Sršen and Sando Mur in 2013. Bellabeat offers multiple products that monitor and provides insights such as user activity, sleep, stress, health, etc. 

To present important recommendations based on my analysis to the Bellabeat executive team, the objective is to examine the smart device usage data to gain insight on how consumers are using their smart devices.

- - -

### **2. Ask Phase**  

**2.1 Business task**  

Analyze the smart device usage data and identify potential opportunities to help improve Bellabeat marketing strategy. In order to do so, the following questions will be answered:

1. What are some trends in smart device usage?  
2. How could these trends apply to Bellabeat customers?  
3. How could these trends help influence Bellabeat marketing strategy? 

- - -

### **3. Prepare Phase**  

**3.1 Dataset used**  

[The FitBit Fitness Tracker Data](https://www.kaggle.com/datasets/arashnic/fitbit)

**3.2 Data privacy**  

This data is licensed under CC0: Public Domain Dedication, in which the work to the public domain waives all of his or her rights to the work worldwide under copyright law, including all related and neighboring rights, to the extent allowed by law. Also able to copy, modify, distribute and perform the work, even for commercial purposes, all without asking permission.

**3.3 Information about the dataset**  

This dataset contains data from thirty FitBit users. Generated by respondents to a distributed survey via Amazon Mechanical Turk between 04.12.2016-05.12.2016. The thirty eligible FitBit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. 

**3.4 Organizing and verifying data's integrity**  

This dataset consists of 18 .csv files. 15 in long format and 3 in wide format. The dataset includes information from daily activity, calories, sleep records, heartrate, steps, metabolic equivalent of tasks (METs). These informations consists in timeframes of seconds, minutes, hours as well as days.

**3.5 Data restrictions**  

Some problems with the data may affect the overall analysis such as:  

- **Small sample size**: Only contains thirty users which is not ideal when trying to analyze and make a decision since there are many variables involved.  

- **Data time period**: Collecting 31 days of data hinders the analysis since many variables will occur, such as the different seasons which will influence people's physical activity.  

- **Demographics**: Gender,age, location, and lifestyle, are key data that were not identified. Even though Bellabeat creates health-focused products for women, we may not know exactly who was a part of the data.  

- **Other context**: Some other information that were not provided which can hinder accurate conclusions may be weather and temperature.  

- - -

### **4. Process Phase**  

Everything from data processing, formatting, cleaning, to visualization are all done in R Studio.  

**4.1 Installing and loading packages**  

The following packages that were used for this analysis are: 'tidyverse', 'tidyr', 'janitor', 'lubridate', 'readr', 'scales', 'RColorBrewer', 'viridis'.
```{r loading packages, message=FALSE}
library(tidyverse)
library(tidyr)
library(janitor)
library(lubridate)
library(readr)
library(scales)
library(RColorBrewer)
library(viridis)
```

- - - 

**4.2 Importing the datasets**  

The following tables were imported and used:

- dailyActivity 

- hourlyCalories  

- sleepDay  

- hourlySteps  

- hourlyIntensities  
```{r loading datasets, message=FALSE}
daily_activity <- read_csv("~/case_study_2/Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
hourly_calories <- read_csv("~/case_study_2/Fitabase Data 4.12.16-5.12.16/hourlyCalories_merged.csv")
sleep_day <- read_csv("~/case_study_2/Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
hourly_steps <- read_csv("~/case_study_2/Fitabase Data 4.12.16-5.12.16/hourlySteps_merged.csv")
hourly_intensities <- read_csv("~/case_study_2/Fitabase Data 4.12.16-5.12.16/hourlyIntensities_merged.csv")
```

- - - 

**4.3 Previewing the datasets**
```{r previewing datasets, message=FALSE}
head(daily_activity)
head(hourly_calories)
head(sleep_day)
head(hourly_steps)
head(hourly_intensities)
```

- - - 

**4.4 Data cleaning and formatting**  

Since we got to know more about the data we are working with, we will now process them and fix any errors and inconsistencies if shown.  

**Formatting date and time columns**  

The first thing I noticed when previewing the data was that the date and time columns were in character format. So let's change that.  
```{r changing character format to date/time}
daily_activity$ActivityDate=as.POSIXct(daily_activity$ActivityDate, format = "%m/%d/%Y",tz = Sys.timezone())
hourly_intensities$ActivityHour=as.POSIXct(hourly_intensities$ActivityHour, format = "%m/%d/%Y %I:%M:%S %p",tz = Sys.timezone())
hourly_calories$ActivityHour=as.POSIXct(hourly_calories$ActivityHour, format = "%m/%d/%Y %I:%M:%S %p",tz = Sys.timezone())
hourly_steps$ActivityHour=as.POSIXct(hourly_steps$ActivityHour, format = "%m/%d/%Y %I:%M:%S %p",tz = Sys.timezone())
sleep_day$SleepDay=as.POSIXct(sleep_day$SleepDay, format = "%m/%d/%Y %I:%M:%S %p",tz = Sys.timezone())
```

**Verify that the columns has been formatted**
```{r check to see if it is formatted correctly}
class(daily_activity$ActivityDate)
class(hourly_calories$ActivityHour)
class(sleep_day$SleepDay)
class(hourly_steps$ActivityHour)
class(hourly_intensities$ActivityHour)
```

- - -

**Verifying the number of users in each dataset**  
```{r verifying how many users in each dataset}
n_distinct(daily_activity$Id)
n_distinct(hourly_steps$Id)
n_distinct(hourly_intensities$Id)
n_distinct(hourly_calories$Id)
n_distinct(sleep_day$Id)
```

**Duplicates**  

Let's see if there are any duplicates
```{r checking for duplicates}
sum(duplicated(daily_activity))
sum(duplicated(hourly_steps))
sum(duplicated(hourly_calories))
sum(duplicated(hourly_intensities))
sum(duplicated(sleep_day))
```
There are 3 in sleep_day so let's also check for null values as well.

**N/A**  
```{r checking for null values}
sum(is.na(daily_activity))
sum(is.na(hourly_steps))
sum(is.na(hourly_calories))
sum(is.na(hourly_intensities))
sum(is.na(sleep_day))
```

**Removing duplicates**  

Since there are no null values, we will only need to remove the duplicated in the sleep_day dataset
```{r removing duplicates in sleep_day}
sleep_day <- sleep_day %>% 
  distinct() %>% 
  drop_na()
```

**Verifying that the data is cleaned**
```{r verification of data cleaning, echo=TRUE}
sum(duplicated(daily_activity))
sum(duplicated(hourly_steps))
sum(duplicated(hourly_calories))
sum(duplicated(hourly_intensities))
sum(duplicated(sleep_day))
```
```{r}
sum(is.na(daily_activity))
sum(is.na(hourly_steps))
sum(is.na(hourly_calories))
sum(is.na(hourly_intensities))
sum(is.na(sleep_day))
```

- - - 

**Rename some columns for consistency**
```{r}
daily_activity <- rename(daily_activity, Date = ActivityDate)
hourly_intensities <- rename(hourly_intensities, DateTime = ActivityHour)
hourly_calories <- rename(hourly_calories, DateTime = ActivityHour)
hourly_steps <- hourly_steps %>% 
  rename("DateTime" = "ActivityHour",
         "TotalSteps" = "StepTotal")
sleep_day <- rename(sleep_day, Date = SleepDay)
```

- - -

**4.5 Merging Datasets**  

I merged all the "hourly" dataframes together into one and also merged 'daily_activity' with 'sleep_day' to make everything easier to read and analyze.
```{r daily_activity and sleep_day df merge, message=FALSE}
# merging daily_activity & sleep_day dataframes
daily_activity_sleep <- merge(daily_activity, sleep_day, by = c("Id","Date"))
head(daily_activity_sleep)
```
```{r hourly df merge, message=FALSE}
# merging all hourly dataframes
hourlies_merged <- merge(hourly_intensities, hourly_steps, by = c("Id", "DateTime"))
hourlies_merged <- merge(hourly_calories, hourlies_merged, by = c("Id", "DateTime"))
head(hourlies_merged)
```

Now that everything is ready, let's explore the dataset and find something interesting.

- - -

### **5. Analyze Phase and Share Phase**  

We will take a quick look at the summary statistics of the datasets:  
```{r summary}
daily_activity %>% 
  select(TotalSteps,
         TotalDistance,
         SedentaryMinutes,
         Calories) %>% 
  summary()

hourly_intensities %>% 
  select(TotalIntensity,
         AverageIntensity) %>% 
  summary()

hourly_steps %>% 
  select(TotalSteps) %>% 
  summary()

hourly_calories %>% 
  select(Calories) %>% 
  summary()

sleep_day %>% 
  select(TotalSleepRecords,
         TotalMinutesAsleep,
         TotalTimeInBed) %>% 
  summary()
```

**Interesting discoveries:**  

- The average total steps per day is 7,638 while research shows that 10,000 steps per day is the recommended target for a long and and healthy lifestyle.  

- The average sedentary time per day is 991 minutes which is equivalent to 16 hours a day. This is a problem!  

- - -

**5.1 Separating by usage type**  

We will distribute the users by how often they use their FitBit watches. Assuming that anything less than 250 steps taken per day are days where those users are not using the watches at all. We will filter and separate these users by:  

- Low Usage- 1 to 10 days 

- Normal Usage- 11- 20 days

- High Usage- 21- 31 days  

```{r users analysis}
daily_use <- daily_activity %>% 
  filter(TotalSteps > 250) %>% 
  group_by(Id) %>% 
  summarize(Date = sum(n())) %>% 
  mutate(Frequency = case_when(
    Date >= 1 & Date <= 10 ~ "Low Usage",
    Date >= 11 & Date <=20 ~ "Normal Usage",
    Date >=21 & Date <=31 ~ "High Usage")) %>% 
  mutate(Frequency = factor(Frequency, level = c("Low Usage", "Normal Usage", "High Usage"))) %>% 
  rename(DaysUsed = Date) %>% 
  group_by(Frequency)
head(daily_use)
```

```{r data transfoming}
# data transformation to create a pie chart
daily_use_percentage <- daily_use %>% 
  group_by(Frequency) %>% 
  summarize(Users = n_distinct(Id)) %>%
  mutate(Percent = Users/sum(Users)) %>% 
  arrange(Users) %>%
  mutate(Percent = scales::percent(Percent))
head(daily_use_percentage)
```

```{r pie chart}
# creating pie chart to show different user types
ggplot(data = daily_use_percentage, aes(fill = Frequency, y = Users, x = ""))+
  geom_bar(stat = "identity", width = 1, color = "white")+
  coord_polar("y", start = 0)+
  scale_fill_brewer(palette = 'Blues')+
  theme_void()+
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.border = element_blank(),
        panel.grid = element_blank(),
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        plot.title = element_text(hjust = 0.5, vjust = -4, size = 16, face = "bold"))+
  geom_text(aes(label = Percent, x = 1.2), position = position_stack(vjust = 0.6))+
  labs(title = "Users Analysis")+
  guides(fill = guide_legend(title = "Usage Type"))
```
**In this study:**  

- 23 out of 33 users are frequently using their devices between 21-31 days. **73%**

- 8 out of 33 users are normally using their devices between 11-21 days. **24%**

- 1 out of 33 users is using their device the least between 1-10 days. **3%**

- - -

**5.2 Relationship between Total Steps and Calories**  
```{r Total Steps vs. Calories}
ggplot(data=daily_activity, aes(x=TotalSteps, y=Calories))+
  geom_point() + geom_smooth()+ 
  labs(title="Total Steps vs. Calories")
```

- There seems to be a positive relation between Total Steps and Calories. Which is apparent since the more active a person is, the more calories they will burn.

- - -

**5.3 Relationship between Total Minutes Asleep and Sedentary Minutes**  
```{r Total Minutes Asleep vs. Sedentary Minutes}
ggplot(data=daily_activity_sleep, aes(x=TotalMinutesAsleep, y=SedentaryMinutes))+
  geom_point() + geom_smooth()+
  labs(title="Minutes Asleep vs. Sedentary Minutes", x="Total Minutes Slept", y="Sedentary Minutes")
```

- We can see that there is a negative relationship between the total sleep time and the total inactive time.  

- An aim to reduce sedentary time and improve user's sleep could be notifications through Bellabeat app when users are being inactive for a long duration. 

- - - 

**5.4 Relationship between Total Minutes Asleep and Total Time In Bed**  
```{r Total Minutes Asleep vs. Total Time In Bed}
ggplot(data=sleep_day, aes(x = TotalTimeInBed, y = TotalMinutesAsleep))+
  geom_point() + geom_smooth()+
  labs(title="Total Minutes Asleep vs. Total Time In Bed",
       x= "Total Minutes Slept", y= "Total Time In Bed")
```

- There is a clear positive correlation between the total sleep time and the total time in bed which is also obvious since more time sleeping means more time in bed.  

- However, comparing this graph to the one above, we must come up with a happy medium where **sedentary minutes** and **total time in bed** can both be reduced simultaneously.  

- - -

**5.5 Relationship between Time of Day and Total Intensity** 
```{r new df for Time and the Average Total Intensity}
# Let's make a new df for just Time and Mean Total Intensity
total_intensity <- hourly_intensities %>%
  separate(DateTime, into=c('Date', 'Time'), sep=' ') %>% 
  group_by(Time) %>% 
  summarise(AvgTotalIntensity = mean(TotalIntensity))
```

```{r Time vs. Average Total Intensity}
ggplot(data=total_intensity, aes(x=Time, y=AvgTotalIntensity))+
  geom_histogram(stat = "identity", fill = "blue")+
  theme(axis.text.x = element_text(angle = 90))+
  labs(title="Average of Total Intensity vs. Time", y="Average Total Intensity")
```

- We can see the increase in intensity as the morning continues until it drops a little and then increases again in the evening.  

- In other words, the users are the most active in the afternoon and evening.

- - - 

**5.6 Average Steps Per Hour**  
We can further prove if the users are the most active at those certain time by seeing how many steps taken per hour.  
```{r separating DateTime column, echo=TRUE, message=FALSE}
# Separating DateTime into two columns and adding an AvgStepsHourly column
hourlies_merged <- hourlies_merged %>%
  separate(DateTime, into=c('Date', 'Time'), sep=' ') %>% 
  group_by(Time) %>% 
  mutate(AvgStepsHourly = mean(TotalSteps)) 
```

```{r Average Steps Per Hour}
ggplot(data=hourlies_merged, aes(x=Time, y=AvgStepsHourly, group=1)) +
  geom_line(color = 'purple', linewidth = 1) + 
  theme(axis.text.x = element_text(angle = 90))+
  labs(title="Average Steps Per Hour")+
  xlab("The Hour of Day") + ylab("Average Steps") +
  annotate("rect", xmin = "11:00:00", xmax = "15:00:00",
           ymin = 0, ymax = 700, alpha = .2) +
  annotate("rect", xmin = "16:00:00", xmax = "20:00:00",
           ymin = 0, ymax = 700, alpha = .2)+ 
  annotate("text", x = "13:00:00", y = 650,
           label = "Afternoon", hjust = 'center', size = 4)+
  annotate("text", x = "18:00:00", y = 650,
           label = "Evening", hjust = 'center', size = 4)
```

- This proves that the steps taken per hour and the average total intensity goes hand in hand.

- As said before, the peak of user activity is in the afternoon and evening.  

- - - 

### **6. Act Phase (Recommendations)**  
**1) It's greater than what they expect**

Getting users to understand that the fitness tracker can 100% help guide them into a healthy routine lifestyle is what it should be all about. Proving that frequent device use will lead to more crucial and accurate recommendations for that specific user. Even though my analysis shows that 73% of the users use their device the most frequent, we need to still understand the reasoning for the 'low' and 'normal' usage users. One of a few conclusions we can assume is that the device is not as user friendly as it should be.  
App developers should focus on making the smart device app more intuitive for almost all age groups. Both devices should also be able to sync with one another whether it is online or offline via bluetooth. This would most definitely help for locations that don't get as much internet connection.
Marketing this to consumers should focus on how their devices are able to help more than just 'fitness fanatics'. 

**2) Push notifications and in-app notifications**  

Since the data can be acquired in minutes, hourly, and daily. Being able to set individual goals would help users stay motivated throughout the days, weeks, and even months. However, since all of Bellabeat's smart wellness products are made to be used alongside their app, that means the consumers will have to physically open up the app each time in order to see their insights or recommendations. Push notifications and in-app notifications informing uses that their goals are met or letting them know that it is almost met would be very helpful. For example, we have shown that the most activity was in the afternoon and evening. Push notifications around these times could remind and motivate users to go exercise.  

**3) Other types of notifications**

Other notifications other than motivation to go exercise should also be implemented. As we saw before, the total sedentary minutes is 16 hours per day. Notifications should be shown to let users know that they have been sedentary for 'x' amount of time without getting up. Vibrations on Bellabeat's physical products could be another way to notify users about this as well.  
Alongside sedentary minutes, if users want to improve their sleep, Bellabeat app can notify how long they've slept for and recommend tips every morning to start their day.  

**4) More data and studies**  
As said in the beginning of this project, the data is very limited and many variables that are very much necessary were not included. Be mindful that not every trend and relationship shown will be as accurate because of the inability to deduce a relationship between the two variables given how much data there was. 

